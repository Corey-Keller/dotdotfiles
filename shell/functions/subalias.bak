#!/bin/sh
# Enable creating aliases with subcommands
# https://alexjgriffin.com/post/shell-subaliases/
function subalias()
{
  local cmd body name

  name="${1%%=*}"
  cmd="${name%_*}"
  body="${1#*=}"

  eval "$cmd"'() {
      local cmd='"$cmd"' subcmd="$1"
      if type "${cmd}_${subcmd}" >/dev/null 2>&1; then
          shift
          "${cmd}_${subcmd}" "$@"
      elif type "${cmd}_${subcmd}_subalias" >/dev/null 2>&1; then
          shift
          "${cmd}_${subcmd}_subalias" "$@"
      elif type "${cmd}_subalias" >/dev/null 2>&1; then
          "${cmd}_subalias" "$@"
      else
          command "$cmd" "$@"
      fi
  }'

  if test "$body" != "$1"; then
      eval "${name}_subalias"'() { '"$body"'; }'
  fi
}
